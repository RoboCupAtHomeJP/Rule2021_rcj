**現在ルール策定中ですので，今後変更となる可能性があります．**

# Tidy Up for OPL
* 本タスクは部屋の片付けを通じて，物体認識と物体把持にフォーカスする．
* 本競技のルールは，[World Robot Summit 2020](https://worldrobotsummit.org) の World Robot Challenge の競技の一つ，Tidy Upのカスタマイズ版である．
* [WRS2020ルールブック](https://wrs.nedo.go.jp/wrs2020/challenge/download/Rules/DetailedRules_Partner_EN.pdf)を参照し，本家ルールと違う点のみ本ドキュメントに示す．（本家ルールより本ドキュメントルールの方が優先される）

## Rule

### 2 Partner Robot Challenge Real Space

#### 2.2 Competition

- 大会では，全参加チームが同時に競技（タスク）を実施する
- タスクは3回行われ，各チーム3回のうちの最高得点がそのチームの得点となる
  - 各回の間にはインターバルが設けられる

#### 2.3 Standard Robot Platform

- 本タスクでは標準機は設定されない．ロボットインスペクションを通過したロボットが出場可能である

### 3 General Rules Tidy Up Here

#### Settings

##### Environment

- アリーナはWRS2020と同じものが用いられるが，オンラインチーム等一部チームでは完全に再現できないケースも許容される

##### Objects

- Known objects: 事前に運営委員から，3クラス（Food items，Kitchen items，Task items），各クラス3オブジェクト，全9オブジェクトのリストが公開される
- Unknown objects: 3クラス，各クラス1オブジェクト，全3オブジェクトが設定され，競技開始直前に運営委員より告知される．
- Boss-character: 本タスクではBoss-characterは設定されない

#### 3.5 Before the Competition

競技の数日～数週間前

- 各チームには，オブジェクトの現物が運営委員より郵送で届けられる
  - Known objectsは届き次第開封し，調整に用いてよい
  - Unknown objectsは，その旨が箱に書いてあるので，開封してはならない

競技の30分前から

- 運営委員はオブジェクトの初期設置場所を各チームへ伝えるので，各チームはその通りにオブジェクトを並べなければならない
- 運営委員は各チームへUnknown objectsの番号を指定するので，各チームはその番号の箱を開け，中のオブジェクトを取り出し，運営委員の指示通りに設置しなければならない

#### 3.6 During the Competition

- タスクは全ての参加チームが同時に実施する
- タスクは3回行われ，各チーム3回のうちの最高得点がそのチームの得点となる
- チームの最高得点が最も高いチームの優勝とする

### 3.7 Scores

- Bonus Points
  - Boss-character: Boss-characterは設定されない．そのため，これに関連したボーナスポイントはない
  - Opening the three shelf drawers: 本タスクではボーナスポイントは与えられない（本タスクではドロアーは使われず，タスク実施中は常に閉じている）

### 3.10-11 Score Sheet
- Special Penaltiesの2項目は削除される
  - リスタートを3回以上繰り返すことに対するペナルティはない
  - 非常停止スイッチを押すことをレフェリーに指示されることに対するペナルティはない
    - これは「ロボットの停止をレフェリーが指示することはない」という意味ではない


### 4 Appendix

#### 4.2 Arena Setup

##### 4.2.1 Room 1

- Search AreaはLong Table Bに限定される（全てのオブジェクトはLong Table Bに置かれる．Tall Tableや床にオブジェクトが設置されることはない）
- Search Areaのオブジェクト数は5つであり，4つがKnown object，1つがUnknown objectである

##### 4.2.2 Room 2

- Obstacle Avoidance AreaやFood Areaに置かれるものは，全てのクラスから選ばれる
  - Obstacle Avoidance Areaには3つのKnown objectsが設置される
  - Food Areaには2つのKnown objectsと1つのUnknown objectsが設置される
    - 設置されるオブジェクトはFood itemsに限定されない
- Food Areaのオブジェクトは，お互いに別のオブジェクトを隠すように置かれることはない

#### 4.3 Object to be used

- YCBオブジェクトは使用されない
- 現在運営委員で選定中である
- オブジェクトはロボットに持ちやすいものが設定される．例えばFood itemsでは，[2019年](https://github.com/RoboCupAtHomeJP/AtHome2019/blob/master/OPL_ObjectList_Known%26Alike.pdf)や[2020年](https://github.com/RoboCupAtHomeJP/AtHome2020/blob/master/documents/OPL_Object_List_2020.pdf)のオブジェクトリストのようなものが選ばれる

## Bypassing

このタスクにはバイパスルールが適用される

### 把持に関するバイパス

アームを搭載していないロボットや，アームを制御できないロボットが出場する場合において，物体把持が求められる状況に直面した時，それ以上タスクを遂行することができない．バイパスルールとは，競技会で可能な限りロボットのパフォーマンスを披露するため，ロボットがアーム制御までのタスクを達成した場合，アーム制御のみをスキップする（バイパスする）ルールである．このルールでは，物体を正確に認識できたことを明示的にレフェリーに示すことができた場合，バイパスルールを適用することで，ロボットがアームを制御する代わりに，レフェリーやオペレーターが物体を把持して，ロボットはタスクを続行することができる．但し，バイパスルールを適用した場合，物体把持に関する得点は加算されない．

- Task 1

  - ロボットが物体を把持できない場合，ロボットが明瞭に，かつ正確に物体の場所（「ロボットから見て真正面にある」「テーブルの右からN個目」等）と名前を伝えることが出来る場合，ロボットは把持をバイパスすることができる．ロボットは，例えば，物体を指して，あるいは明確に対象物体の方向を向いて「目の前にある○○という物体を私に乗せてくれ」等と伝えなければならない．この指示が誤っていた場合，レフェリーはロボットを手伝うことができない．

    - この場合，Deliveryの点数は0点である

  - またロボットが物体を設置できない場合，ロボットが明らかに物体を収納する場所に来て「私が持っている○○という物体を，目の前のXXへ収納してくれ」等と伝えた場合，レフェリーはロボットを手伝う．すなわち，レフェリーが物体設置時にロボットを手伝うには，下記の条件を満たしている必要がある

    - ロボットが，自分が持っている物体の名前を正しく言う
    - ロボットが，収納して欲しい場所の名前を言う
    - ロボットが，明らかに，上述した「収納して欲しい場所」の前にいる

    これらの条件を満たしたとき，レフェリーはロボットを手伝う．その結果，正しい場所に正しい物体が収納された場合，Categoryの点数が加点される

- Task 2b

  - ロボットが物体を把持できない場合，ロボットが明瞭に，かつ正確に物体の場所（「ロボットから見て真正面にある」「テーブルの右からN個目」等）と名前を伝えることが出来る場合，ロボットは把持をバイパスすることができる．ロボットは，例えば，物体を指示棒などで指して，あるいは明確に対象物体の方向を向いて「目の前にある○○という物体を私に乗せてくれ」等と伝えなければならない．この指示が誤っていた場合，レフェリーはロボットを手伝うことができない．

    - この場合，Taking any food item in the shelfの点数は0点である
    - 同様に，Taking the requested object among many objects in the shelfの点数も0点である

  - ロボットがDelivery Areaで人に物体を渡す際，ロボットが物体を把持できない場合，下記条件を満たしているならばDelivery Areaの人はレフェリーによりロボット上の特定の場所に置かれた物体を，渡されることなく受け取ることができる

    - ロボットが明らかに，人の前にいる
    - ロボットが「私の○○に載っている物体を受け取ってくれ」と伝え，その場所に物体が載っている

    その結果，正しい人物が正しい物体を持つことが出来た場合，次の点数計算が行われる

    - Delivering the object to a person in the delivery areaの点数は0点である（ロボット単独でDelivery出来ていないため）
    - Correctly detecting a person’s request and giving the item to her/himの点数60点が加点される

## お知らせ

* タスクの理解の参考に，[こちらの動画](https://youtu.be/-73t0L2woi8)を合わせてご覧ください
